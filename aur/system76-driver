# Maintainer: ava1ar <mail(at)ava1ar(dot)info>

pkgname=system76-driver
pkgver=13.04.10
pkgrel=1
pkgdesc="System76 Laptops Driver. Tested on System76 Galago UltraPro."
arch=('any')
url="https://www.system76.com/"
license=('GPL')
depends=('python' 'python-gobject' 'dmidecode' 'python-dbus')
install="${pkgname}.install"
source=("https://launchpad.net/~system76-dev/+archive/stable/+files/${pkgname}_${pkgver}.tar.gz"
		'arch_galu1.patch'
		'system76.service'
)
sha1sums=(
	'3ae9f2af0dda700b66a0eb3f7a9b3bbeda67ad12'
	'57dad8a3888dc902707bd5092f275770cd50fdfa'
	'cf763432441c3da0563eee041145a02109f2bb3a'
)

package() {
	cd ${srcdir}/${pkgname}-${pkgver}
	# script
	install -m644 -D system76-daemon ${pkgdir}/usr/lib/${pkgname}/system76-daemon
	mkdir -p ${pkgdir}/var/lib/${pkgname}
	# python module
	python setup.py install --prefix=/usr --root=${pkgdir} --optimize=1
	cd ${pkgdir} &&	patch -Np1 -i ${srcdir}/arch_galu1.patch 
	# systemd service
	install -m644 -D ${startdir}/system76.service ${pkgdir}/usr/lib/systemd/system/system76.service
} 
