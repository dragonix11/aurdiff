# Maintainer: Moritz Maxeiner <moritz@ucworks.org>

pkgname=seafile-shared
pkgver=2.0.5
pkgrel=2
pkgdesc="Shared components of seafile: seafile-daemon, libseafile, libseafile python bindings, manuals"
arch=('i686' 'x86_64')
url="https://github.com/haiwen/seafile/"
license=('GPL')
depends=('ccnet>=1.3.5' 'libevent' 'vala')
makedepends=()
optdepends=()
options=('!libtool' '!emptydirs')
source=("https://github.com/haiwen/seafile/archive/v${pkgver}.tar.gz")
md5sums=('af83680e3d9a836f1adfebabc66e7aad')
sha256sums=('380b11168a7c55851db5663f739b0967f204df92b000b37c73f887a29044a0c2')

build ()
{
	cd "$srcdir/seafile-${pkgver}"
    ./autogen.sh
    ./configure --disable-server --disable-gui --disable-console --prefix=/usr PYTHON=/usr/bin/python2
	make -j1
}

package ()
{
	cd "${srcdir}/seafile-${pkgver}"
	make DESTDIR="${pkgdir}/" install

    # Remove seafile binary
    rm -rf "${pkgdir}/usr/bin/seafile"
    # Remove cli client binary
    rm -rf "${pkgdir}/usr/bin/seaf-cli"

	install -D -m644 ${srcdir}/seafile-${pkgver}/LICENCE.txt ${pkgdir}/usr/share/licenses/${pkgname}/LICENCE.txt
}
