# Maintainer: peace4all <markspost at rocketmail dot com>

pkgname=rhythmbox-countdown-playlist-git
_gitname="countdown-playlist"
pkgver=9e751f0
pkgrel=1
pkgdesc="Plugin to create playlists from your music collection using keywords for a defined duration"
url="https://github.com/fossfreedom/countdown-playlist"
arch=('i686' 'x86_64')
license=('GPLv3')
makedepends=('git')
depends=('rhythmbox>=2.9')
source=("$_gitname::git+https://github.com/fossfreedom/countdown-playlist.git"
	"arch-rb-compat.patch")
md5sums=('SKIP'
	 'bd3a4de8b9448a856c92f4502a9f37c3')

pkgver() {
  cd "${srcdir}/${_gitname}"
  git describe --always | sed 's|-|.|g'
}

package() {
  cd "${srcdir}/${_gitname}"

  # patch for latest rhythmbox from arch extra
    patch -Np1 -i "$srcdir/arch-rb-compat.patch"

  mkdir -p "$pkgdir/usr/lib/rhythmbox/plugins/$_gitname"
  mv README.md README
  mv LICENSE.txt LICENSE
  cp -R {*.py,*.plugin,README,LICENSE} "$pkgdir/usr/lib/rhythmbox/plugins/$_gitname/"
}
