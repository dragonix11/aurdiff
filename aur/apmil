# Contributor: Lex Black <autumn-wind at web dot de>
# Contributor: Alexander Preisinger <alexander dot preisinger at gmail dot com>

pkgname=apmil
pkgver=0.4.0
pkgrel=3
pkgdesc="APMIL Manga Image Downloader"
arch=(any)
url="http://sharesource.org/project/apmil/"
license=('GPL')
depends=('python2' 'wxpython')
source=(http://dl.sharesource.org/apmil/${pkgname}-${pkgver}.tar.bz2
	0001_change-xdg.patch)
md5sums=('17791dd76f4825ce5dc1072bdf651c51'
         '72935ddb5d596db67d332bba5a7bdae1')


prepare() {
  cd ${pkgname}  

  sed -i "s/python/python2/" apmil.py
  patch -p2 -i ../0001_change-xdg.patch
}

package() {
  cd ${pkgname}

  mkdir -p ${pkgdir}/usr/share/apmil/ 
  install -m 644 ./*.py ${pkgdir}/usr/share/apmil/
  chmod 755 ${pkgdir}/usr/share/apmil/apmil.py

  mkdir -p ${pkgdir}/usr/bin/
  ln -s ${pkgdir}/usr/share/apmil/apmil.py ${pkgdir}/usr/bin/apmil

  install -D -m 644 ./LICENCE.txt ${pkgdir}/usr/share/licenses/apmil/LICENCE
  install -D -m 644 ./ap_logo.png ${pkgdir}/usr/share/pixmaps/ap_logo.png
  install -D -m 644 ./apmil.desktop ${pkgdir}/usr/share/applications/apmil.desktop

  mkdir -p ${pkgdir}/usr/share/apmil/locale/
  install -D -m 644 ./locale/*.mo ${pkgdir}/usr/share/apmil/locale/
    
  mkdir -p ${pkgdir}/usr/share/apmil/plugins/
  install -D -m 644 ./plugins/* ${pkgdir}/usr/share/apmil/plugins/
}
