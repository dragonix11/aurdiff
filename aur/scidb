# Maintainer: archtux <antonio dot arias99999 at gmail dot com>

pkgname=scidb
_realpkgname=scidb-beta
pkgver=1.0beta.rev701
_realpkgver=2013-04-01--rev701
pkgrel=3
pkgdesc="Scidb is a Chess Information Data Base"
url="http://scidb.sourceforge.net/"
arch=('i686' 'x86_64')
license=('GPL2')
depends=('gdbm' 'libxcursor' 'tk' 'zziplib')
conflicts=('scidb-svn')
options=('!buildflags' '!makeflags')
source=(http://sourceforge.net/projects/$pkgname/files/$_realpkgname--$_realpkgver.tar.gz
        $pkgname.desktop)
md5sums=('4a244aa78ef319e6685a531684141e9b'
         '16ebfb8498c2806cfbb7e53e8c631a71')

prepare() {
   cd $srcdir/$_realpkgname--$_realpkgver

  ./configure --prefix=$pkgdir/usr --exec-prefix=$pkgdir/usr --mandir=$pkgdir/usr/share/man --enginesdir=$pkgdir/usr/bin
   
   # Delete section fonts install in Makefile, copy fonts in package function
   sed -i '474,495d' tcl/Makefile
}

build() {
   cd $srcdir/$_realpkgname--$_realpkgver
   
   make
}

package () {
   cd $srcdir/$_realpkgname--$_realpkgver

   make install

   # Desktop icon
   install -Dm644 scidb.ico $pkgdir/usr/share/pixmaps/scidb.ico
   install -Dm644 ../scidb.desktop $pkgdir/usr/share/applications/scidb.desktop   
   
   # Fonts
   echo "Install fonts"
   install -dm644 $pkgdir/usr/share/fonts/truetype/Scidb
   cp tcl/fonts/*.ttf $pkgdir/usr/share/fonts/truetype/Scidb
}