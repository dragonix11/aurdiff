# Maintainer: ksj <podhorsky.ksj@gmail.com>
# Contributor: ksj <podhorsky.ksj@gmail.com>

_pkgname=avidemux
pkgname="$_pkgname"-2.6
pkgver=2.6.4
pkgrel=1
pkgdesc="A graphical tool to edit video (filter/re-encode/split)"
arch=(i686 x86_64)
url=http://fixounet.free.fr/avidemux/
license=(GPL2)
depends=(libxml2 qt4)
makedepends=(cmake yasm fribidi mesa glibc libva fontconfig jack libxext glu lame libpulse
			sqlite libxv faad2 libvpx freetype2 libx11 zlib faac opencore-amr libvorbis
			libdca faac x264 sdl alsa-lib lame xvidcore libxv)
optdepends=(libvorbis libdca faad2 faac x264 sdl alsa-lib lame xvidcore libxv)
provides=($pkgname=2.6.4)
#conflicts=($_pkgname)
source=(http://sourceforge.net/projects/avidemux/files/avidemux/"$pkgver"/"$_pkgname"_"$pkgver".tar.gz)
sha256sums=('2937c6c09248445942ac7e71b100ff8f7e272c4ad9c38e7d8c519ce4a11cec44')
sha512sums=('1b80f65ac5a1da844b521a82bab8976d01c81923460004dc76ed0f6994f95da0ad9a836c90ffa1595ad060f0d6f27ce30add0204ca9d5295084a62e79dd484c9')

build() {
    cd $srcdir/"$_pkgname"_"$pkgver"
    bash bootStrap.bash
    sed -i -e 's/avidemux2_gtk/avidemux3_qt4/g' "$_pkgname"2.desktop
    sed -i -e 's/avidemux2/avidemux/g' "$_pkgname"2.desktop
}

package() {
    cd $srcdir/"$_pkgname"_"$pkgver"
    cp -r install/usr/ "$pkgdir"/

    install -Dm644 "$_pkgname"_icon.png "$pkgdir"/usr/share/pixmaps/$_pkgname2.png

    desktop-file-install "$_pkgname"2.desktop --dir "$pkgdir"/usr/share/applications/$_pkgname.desktop
}
