# Contributor: Jonathan Arnold <jdarnold@buddydog.org>

pkgname=iceray-git
pkgver=0.0.0
pkgrel=2
pkgdesc="Icecast/Shoutcast commandline client"
arch=('i686' 'x86_64')
url="https://github.com/jdarnold/iceray"
license=('MIT')
depends=('libshout')
makedepends=('git' 'go')
conflicts=('iceray')
provides=('iceray')
# The git repo is detected by the 'git:' or 'git+' beginning. The branch
# 'pacman41' is then checked out upon cloning, expediating versioning:
#source=('git+https://github.com/falconindy/expac.git'
source=("$pkgname"::'git://github.com/jdarnold/iceray.git')
# Because the sources are not static, skip Git checksum:
md5sums=('SKIP')
_gourl="https://github.com/jdarnold/iceray"

pkgver() {
	cd "$pkgname"
	# Use the tag of the last commit
	local ver="$(git describe --tags)"
	printf "%s" "${ver//-/.}"
}

build() {
    cd "$srcdir/$pkgname"
    go build
}

package() {
    cd "$srcdir/$pkgname"
    install -Dm755 "$pkgname" "$pkgdir"/usr/bin/iceray
    #install -D -m644 expac.1 $(DESTDIR)$(MANPREFIX)/man1/expac.1
}
