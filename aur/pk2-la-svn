# Maintainer: Maurizio D'Addona <mauritiusdadd@gmail.com>
pkgname=pk2-la-svn
pkgver=16
pkgrel=1
pkgdesc="Program to use the Microchip PICkit 2 has as a logic analyzer and I/O probe"
arch=('any')
url="http://sourceforge.net/projects/pk2-la/"
license=('GPL2')
depends=('python2' 'python2-pyusb' 'pygtk')
provides=('pk2-la')
conflicts=('pk2-la')
makedepends=('svn')
_svntrunk=http://svn.code.sf.net/p/pk2-la/code/
_svnmod=pk2-la-code

build() 
{
    cd "$srcdir"
    msg "Connecting to SVN server...."
    if [[ -d "$_svnmod/.svn" ]]; then
        (cd "$_svnmod" && svn up -r "$pkgver")
    else
        svn co "$_svntrunk" --config-dir ./ -r "$pkgver" "$_svnmod"
    fi
    [ -d "$srcdir/$_svnmod-build" ] && rm -rf "$srcdir/$_svnmod-build"
    svn export "$srcdir/$_svnmod" "$srcdir/$_svnmod-build"
    
    msg "Patching files...."
    sed -i "s/python/python2/g" $srcdir/$_svnmod-build/pk2-la
    
}


package() 
{
    cd $_svnmod-build/
    msg "Copying files..."
    install -Dm755 pk2-la $pkgdir/usr/bin/pk2-la
    install -Dm644 COPYING $pkgdir/usr/share/licenses/pk2-la/COPYING
} 