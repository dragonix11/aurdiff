pkgname=ppcross386
pkgver=2.7.1
pkgrel=1
pkgdesc="Free Pascal cross compiler for i386"
arch=(x86_64)
url="http://www.freepascal.org"
license=("GPL" "LGPL" "custom")
depends=("fpc>=2.6.2")
makedepends=(subversion)
source=("${pkgname%-*}::svn+http://svn.freepascal.org/svn/fpc/trunk")
md5sums=('SKIP')

build() {
  cd "$srcdir/${pkgname%-*}/compiler"
  fpcmake -Tall
  make OPT="-O2" i386
}

package() {
  install -Dm755 "${srcdir}/ppcross386/compiler/ppc386" "$pkgdir/usr/lib/fpc/$pkgver/ppcross386"
  mkdir -p "$pkgdir/usr/bin"
  cd "$pkgdir/usr/bin"
  ln -s "/usr/lib/fpc/$pkgver/ppcross386" .
}
