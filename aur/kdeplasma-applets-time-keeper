# Maintainer: hbdee <hbdee.arch@gmail.com>

pkgname=kdeplasma-applets-time-keeper
_pname=timekeeper
pkgver=0.4
pkgrel=1
pkgdesc="This plasmoid provides a clock and a calendar function via steampunk interface."
arch=('any')
url="http://kde-apps.org/content/show.php?content=159345"
license=('GPL')
depends=('kdebase-workspace' 'kdeedu-marble')
makedepends=('unzip')
conflicts=('kdeplasma-applet-time-keeper')
backup=('usr/share/apps/plasma/plasmoids/timekeeper/contents/config/main.xml')
source=("http://kde-apps.org/CONTENT/content-files/159345-${_pname}.plasmoid")
md5sums=('60f4de7f000a054d17161f8be19989e4')

prepare() {
  unzip -o -q "${srcdir}/159345-${_pname}.plasmoid" -d "${srcdir}/${_pname}"
}

package() {
  cd ${srcdir}/${_pname}
  sed -i 's;icon.png;timekeeper.png;g' metadata.desktop
  install -Dm644 metadata.desktop ${pkgdir}/usr/share/kde4/services/plasma-applet-timekeeper.desktop
  install -Dm644 icon.png $pkgdir/usr/share/pixmaps/${_pname}.png
  mkdir -p ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/{calendar,clock/{back,wheels},config,luna,otherside,terra,timekeeper}
  install -Dm644 metadata.desktop ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/metadata.desktop
  install -Dm644 contents/main.qml ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/main.qml
  install -Dm644 contents/calendar/* ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/calendar
  install -Dm644 contents/clock/{*.png,Clock.qml,Engravers_MT.ttf} ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/clock
  install -Dm644 contents/clock/back/* ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/clock/back
  install -Dm644 contents/clock/wheels/* ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/clock/wheels
  install -Dm644 contents/config/* ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/config
  install -Dm644 contents/luna/* ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/luna
  install -Dm644 contents/otherside/* ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/otherside
  install -Dm644 contents/terra/* ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/terra
  install -Dm644 contents/timekeeper/* ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/timekeeper
}
 
